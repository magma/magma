swagger: "2.0"
info:
  title: LTE Policy Management
  description: LTE REST APIs
  version: 1.0.0
basePath: /magma/v1
consumes: []
produces: []
schemes: []
tags:
- description: Endpoints related to network policy management
  name: Policies
- description: Endpoints related to rating group management
  name: Rating Groups
paths:
  /lte/{network_id}/policy_qos_profiles:
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      responses:
        "200":
          description: Policy QoS profiles in the network
          schema:
            additionalProperties:
              $ref: '#/definitions/policy_qos_profile'
            type: object
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Get policy QoS profiles in LTE network
      tags:
      - Policies
    post:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - description: Policy QoS profile
        in: body
        name: policy
        required: true
        schema:
          $ref: '#/definitions/policy_qos_profile'
      responses:
        "201":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Create policy QoS profile in LTE network
      tags:
      - Policies
  /lte/{network_id}/policy_qos_profiles/{profile_id}:
    delete:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/policy_qos_profile_id'
      responses:
        "204":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Delete policy QoS profile in LTE network
      tags:
      - Policies
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/policy_qos_profile_id'
      responses:
        "200":
          description: Policy QoS profie
          schema:
            $ref: '#/definitions/policy_qos_profile'
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Get policy QoS profile in LTE network
      tags:
      - Policies
    put:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/policy_qos_profile_id'
      - description: Policy QoS profile
        in: body
        name: profile
        required: true
        schema:
          $ref: '#/definitions/policy_qos_profile'
      responses:
        "204":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Update policy QoS profile in LTE network
      tags:
      - Policies
  /networks/{network_id}/policies/base_names:
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      responses:
        "200":
          description: List of all base names
          schema:
            items:
              $ref: '#/definitions/base_name'
            type: array
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: List Charging Rule Base Names
      tags:
      - Policies
    post:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - description: Charging Rule Base Name to add
        in: body
        name: base_name_record
        required: true
        schema:
          $ref: '#/definitions/base_name_record'
      responses:
        "201":
          description: Charging Rule Base Name
          schema:
            $ref: '#/definitions/base_name'
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Create Charging Rule Base Name
      tags:
      - Policies
  /networks/{network_id}/policies/base_names/{base_name}:
    delete:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/base_name'
      responses:
        "204":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Delete a Charging Rule Base Name
      tags:
      - Policies
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/base_name'
      responses:
        "200":
          description: Charging Rule Base Name on success
          schema:
            $ref: '#/definitions/base_name_record'
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Get Charging Rule Base Name
      tags:
      - Policies
    put:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/base_name'
      - description: Charging Rule Base Name
        in: body
        name: base_name_record
        required: true
        schema:
          $ref: '#/definitions/base_name_record'
      responses:
        "204":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Modify a Charging Rule Base Name
      tags:
      - Policies
  /networks/{network_id}/policies/base_names?view=full:
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      responses:
        "200":
          description: Map of all base names in the network by name
          schema:
            additionalProperties:
              $ref: '#/definitions/base_name_record'
            type: object
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Get all base names
      tags:
      - Policies
  /networks/{network_id}/policies/rules:
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      responses:
        "200":
          description: List all policy rule IDs
          schema:
            items:
              $ref: '#/definitions/rule_id'
            type: array
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: List policy rules
      tags:
      - Policies
    post:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - description: Policy rule to add
        in: body
        name: Policy rule
        required: true
        schema:
          $ref: '#/definitions/policy_rule'
      responses:
        "201":
          description: Rule id
          schema:
            $ref: '#/definitions/rule_id'
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Add a new policy rule
      tags:
      - Policies
  /networks/{network_id}/policies/rules/{rule_id}:
    delete:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/rule_id'
      responses:
        "204":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Delete a policy rule
      tags:
      - Policies
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/rule_id'
      responses:
        "200":
          description: Policy rule on success
          schema:
            $ref: '#/definitions/policy_rule'
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Get policy rule
      tags:
      - Policies
    put:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/rule_id'
      - description: Policy rule
        in: body
        name: Policy rule
        required: true
        schema:
          $ref: '#/definitions/policy_rule'
      responses:
        "204":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Modify a policy rule
      tags:
      - Policies
  /networks/{network_id}/policies/rules?view=full:
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      responses:
        "200":
          description: Map of all policy rules for the network by rule ID
          schema:
            additionalProperties:
              $ref: '#/definitions/policy_rule'
            type: object
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Get all policy rules
      tags:
      - Policies
  /networks/{network_id}/rating_groups:
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      responses:
        "200":
          description: List all rating groups
          schema:
            items:
              $ref: '#/definitions/rating_group'
            type: array
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: List rating groups
      tags:
      - Rating Groups
    post:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - description: Rating group to add
        in: body
        name: Rating Group
        required: true
        schema:
          $ref: '#/definitions/rating_group'
      responses:
        "201":
          description: Rating group id
          schema:
            $ref: '#/definitions/rating_group_id'
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Add a new rating group
      tags:
      - Rating Groups
  /networks/{network_id}/rating_groups/{rating_group_id}:
    delete:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/rating_group_id'
      responses:
        "204":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Delete a rating group
      tags:
      - Rating Groups
    get:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/rating_group_id'
      responses:
        "200":
          description: Rating group on success
          schema:
            $ref: '#/definitions/rating_group'
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Get rating group
      tags:
      - Rating Groups
    put:
      parameters:
      - $ref: ./orc8r-swagger-common.yml#/parameters/network_id
      - $ref: '#/parameters/rating_group_id'
      - description: Rating group
        in: body
        name: Rating group
        required: true
        schema:
          $ref: '#/definitions/mutable_rating_group'
      responses:
        "204":
          description: Success
        default:
          $ref: ./orc8r-swagger-common.yml#/responses/UnexpectedError
      summary: Modify a rating group
      tags:
      - Rating Groups
responses: {}
parameters:
  base_name:
    description: Charging Rule Base Name
    in: path
    name: base_name
    required: true
    type: string
  policy_qos_profile_id:
    description: Policy QoS profile
    in: path
    name: profile_id
    required: true
    type: string
  rating_group_id:
    description: Rating Group Id
    format: uint32
    in: path
    name: rating_group_id
    required: true
    type: integer
  rule_id:
    description: Rule Id
    in: path
    name: rule_id
    required: true
    type: string
  subscriber_id:
    description: Subscriber ID
    in: path
    name: subscriber_id
    required: true
    type: string
definitions:
  arp:
    description: Allocation and retention priority
    properties:
      preemption_capability:
        default: true
        example: true
        type: boolean
      preemption_vulnerability:
        default: false
        example: false
        type: boolean
      priority_level:
        default: 15
        example: 15
        format: uint32
        maximum: 15
        minimum: 0
        type: integer
    type: object
  base_name:
    example: base_1
    minLength: 1
    type: string
    x-nullable: false
  base_name_record:
    properties:
      assigned_subscribers:
        description: Subscribers which have been assigned this policy base name
        example:
        - IMSI1234567890
        - IMSI0987654321
        items:
          $ref: '#/definitions/subscriber_id'
        type: array
        x-omitempty: true
      name:
        $ref: '#/definitions/base_name'
      rule_names:
        $ref: '#/definitions/rule_names'
    required:
    - name
    - rule_names
    type: object
  base_names:
    description: List of base names
    items:
      $ref: '#/definitions/base_name'
    type: array
  flow_description:
    properties:
      action:
        default: PERMIT
        enum:
        - PERMIT
        - DENY
        type: string
      match:
        $ref: '#/definitions/flow_match'
    required:
    - action
    - match
    type: object
  flow_match:
    properties:
      direction:
        enum:
        - UPLINK
        - DOWNLINK
        type: string
      ip_dst:
        $ref: '#/definitions/ip_address'
        x-go-custom-tag: magma_alt_name:"IpDst"
      ip_proto:
        default: IPPROTO_IP
        enum:
        - IPPROTO_IP
        - IPPROTO_TCP
        - IPPROTO_UDP
        - IPPROTO_ICMP
        type: string
      ip_src:
        $ref: '#/definitions/ip_address'
        x-go-custom-tag: magma_alt_name:"IpSrc"
      ipv4_dst:
        example: 0.0.0.0/0
        format: ip-address
        type: string
        x-go-custom-tag: magma_alt_name:"Ipv4Dst"
      ipv4_src:
        example: 192.168.0.1/24
        format: ip-address
        type: string
        x-go-custom-tag: magma_alt_name:"Ipv4Src"
      tcp_dst:
        format: uint32
        type: integer
        x-go-custom-tag: magma_alt_name:"TcpDst"
      tcp_src:
        format: uint32
        type: integer
        x-go-custom-tag: magma_alt_name:"TcpSrc"
      udp_dst:
        format: uint32
        type: integer
        x-go-custom-tag: magma_alt_name:"UdpDst"
      udp_src:
        format: uint32
        type: integer
        x-go-custom-tag: magma_alt_name:"UdpSrc"
    required:
    - ip_proto
    - direction
    type: object
  flow_qos:
    properties:
      max_req_bw_dl:
        format: uint32
        type: integer
      max_req_bw_ul:
        format: uint32
        type: integer
    required:
    - max_req_bw_ul
    - max_req_bw_dl
    type: object
  gbr:
    description: Guaranteed bit rate
    properties:
      downlink:
        format: uint32
        type: integer
      uplink:
        format: uint32
        type: integer
    required:
    - uplink
    - downlink
    type: object
  ip_address:
    description: IP address
    properties:
      address:
        example: 192.168.0.1/24
        format: ip-address
        type: string
      version:
        enum:
        - IPv4
        - IPv6
        type: string
    type: object
  mutable_rating_group:
    properties:
      limit_type:
        enum:
        - FINITE
        - INFINITE_UNMETERED
        - INFINITE_METERED
        type: string
    required:
    - limit_type
    type: object
  network_subscriber_config:
    description: Network-wide Subscriber Configuration
    properties:
      network_wide_base_names:
        $ref: '#/definitions/base_names'
      network_wide_rule_names:
        $ref: '#/definitions/rule_names'
    type: object
  policy_id:
    example: All ICMP
    minLength: 1
    type: string
  policy_ids:
    description: Policies which are globally active for this subscriber
    example:
    - rule1
    - rule2
    items:
      $ref: '#/definitions/policy_id'
    type: array
    x-omitempty: true
  policy_ids_by_apn:
    additionalProperties:
      $ref: '#/definitions/policy_ids'
    description: APN-specific policies for this subscriber
    type: object
  policy_qos_profile:
    properties:
      arp:
        $ref: '#/definitions/arp'
      class_id:
        $ref: '#/definitions/qos_class_id'
      gbr:
        $ref: '#/definitions/gbr'
      id:
        example: All ICMP
        minLength: 1
        type: string
        x-nullable: false
      max_req_bw_dl:
        format: uint32
        type: integer
      max_req_bw_ul:
        format: uint32
        type: integer
    required:
    - id
    - class_id
    - max_req_bw_ul
    - max_req_bw_dl
    type: object
  policy_rule:
    properties:
      app_name:
        enum:
        - NO_APP_NAME
        - FACEBOOK
        - FACEBOOK_MESSENGER
        - INSTAGRAM
        - YOUTUBE
        - GOOGLE
        - GMAIL
        - GOOGLE_DOCS
        - NETFLIX
        - APPLE
        - MICROSOFT
        - REDDIT
        - WHATSAPP
        - GOOGLE_PLAY
        - APPSTORE
        - AMAZON
        - WECHAT
        - TIKTOK
        - TWITTER
        - WIKIPEDIA
        - GOOGLE_MAPS
        - YAHOO
        - IMO
        type: string
      app_service_type:
        enum:
        - NO_SERVICE_TYPE
        - CHAT
        - AUDIO
        - VIDEO
        type: string
      assigned_subscribers:
        description: Subscribers which have been assigned this policy not as part
          of a base name
        example:
        - IMSI1234567890
        - IMSI0987654321
        items:
          $ref: '#/definitions/subscriber_id'
        type: array
        x-omitempty: true
      flow_list:
        items:
          $ref: '#/definitions/flow_description'
        type: array
      header_enrichment_targets:
        description: List of URL targets for header enrichment
        items:
          example: http://example.com/
          type: string
          x-nullable: false
        type: array
      id:
        $ref: '#/definitions/policy_id'
      monitoring_key:
        example: SGVsbG8gV29ybGQ=
        type: string
      priority:
        default: 10
        format: uint32
        type: integer
      qos_profile:
        description: ID of the QoS profile associated with this policy
        example: profile0
        type: string
      rating_group:
        format: uint32
        type: integer
      redirect:
        $ref: '#/definitions/redirect_information'
      service_identifier:
        format: uint32
        type: integer
      tracking_type:
        enum:
        - ONLY_OCS
        - ONLY_PCRF
        - OCS_AND_PCRF
        - NO_TRACKING
        type: string
    required:
    - id
    - flow_list
    - priority
    type: object
  policy_rule_config:
    properties:
      app_name:
        enum:
        - NO_APP_NAME
        - FACEBOOK
        - FACEBOOK_MESSENGER
        - INSTAGRAM
        - YOUTUBE
        - GOOGLE
        - GMAIL
        - GOOGLE_DOCS
        - NETFLIX
        - APPLE
        - MICROSOFT
        - REDDIT
        - WHATSAPP
        - GOOGLE_PLAY
        - APPSTORE
        - AMAZON
        - WECHAT
        - TIKTOK
        - TWITTER
        - WIKIPEDIA
        - GOOGLE_MAPS
        - YAHOO
        - IMO
        type: string
      app_service_type:
        enum:
        - NO_SERVICE_TYPE
        - CHAT
        - AUDIO
        - VIDEO
        type: string
      flow_list:
        items:
          $ref: '#/definitions/flow_description'
        type: array
      header_enrichment_targets:
        description: List of URL targets for header enrichment
        items:
          example: http://example.com/
          type: string
          x-nullable: false
        type: array
      monitoring_key:
        type: string
      priority:
        default: 10
        format: uint32
        type: integer
      rating_group:
        format: uint32
        type: integer
      redirect:
        $ref: '#/definitions/redirect_information'
      service_identifier:
        format: uint32
        type: integer
      tracking_type:
        enum:
        - ONLY_OCS
        - ONLY_PCRF
        - OCS_AND_PCRF
        - NO_TRACKING
        type: string
    required:
    - flow_list
    - priority
    type: object
  qos_class_id:
    default: 9
    enum:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 65
    - 66
    - 67
    - 70
    - 75
    - 79
    example: 9
    format: int32
    type: integer
    x-go-custom-tag: magma_alt_name:"QCI"
  rating_group:
    properties:
      id:
        $ref: '#/definitions/rating_group_id'
      limit_type:
        enum:
        - FINITE
        - INFINITE_UNMETERED
        - INFINITE_METERED
        type: string
    required:
    - id
    - limit_type
    type: object
  rating_group_id:
    example: 1
    format: uint32
    type: integer
    x-nullable: false
  redirect_information:
    properties:
      address_type:
        enum:
        - IPv4
        - IPv6
        - URL
        - SIP_URI
        type: string
      server_address:
        type: string
      support:
        enum:
        - DISABLED
        - ENABLED
        type: string
    required:
    - support
    - address_type
    - server_address
    type: object
  rule_id:
    example: All ICMP
    minLength: 1
    type: string
    x-nullable: false
  rule_names:
    description: List of rule names
    items:
      example: rule_1
      type: string
      x-nullable: false
    type: array
  subscriber_id:
    example: IMSI208950000000010
    pattern: ^(IMSI\d{10,15})$
    type: string
    x-nullable: false
