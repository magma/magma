<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Federated-FWA Setup Guide · Magma Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Federated-FWA Setup Guide"/><meta name="docsearch:version" content="1.3.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Federated-FWA Setup Guide · Magma Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://magma.github.io/magma/"/><meta property="og:description" content="# Federated-FWA Setup Guide"/><meta property="og:image" content="https://magma.github.io/magma/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://magma.github.io/magma/img/docusaurus.png"/><link rel="shortcut icon" href="/magma/img/icon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script type="text/javascript" src="/init.js"></script><script src="/magma/js/scrollSpy.js"></script><link rel="stylesheet" href="/magma/css/main.css"/><script src="/magma/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/magma/"><img class="logo" src="/magma/img/magma-logo.svg" alt="Magma Documentation"/><h2 class="headerTitleWithLogo">Magma Documentation</h2></a><a href="/magma/versions"><h3>1.3.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://magmacore.org" target="_self">Home</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="/magma/" target="_self">Docs</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://github.com/magma" target="_self">Code</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://magmacore.org/community" target="_self">Community</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Deploy FeG</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Basics<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/basics/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/basics/prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/basics/quick_start_guide">Quick Start Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Orchestrator<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Deploy Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/orc8r/deploy_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/orc8r/deploy_build">Build Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/orc8r/deploy_install">Install Orchestrator</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Upgrade Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/orc8r/upgrade_intro">Orchestrator Upgrades: Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/orc8r/upgrade_1_3">Upgrade to v1.3</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/orc8r/upgrade_1_2">Upgrade to v1.2</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/orc8r/upgrade_1_1">Upgrade to v1.1</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">NMS User Guide<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_overview">NMS Overview</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_dashboard">NMS Dashboard</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_equipment">NMS Equipment</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_network">NMS Network</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_subscriber">NMS Subscriber</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_traffic">NMS Traffic</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_organizations">Multitenancy (Organizations)</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_developer">Quick-Start Guide to NMS Development</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/nms/nms_how_to_guide">NMS How To Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Access Gateway<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Deploy AGWs</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/setup_deb">Setup (Bare Metal)</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/config_agw">AGW Configuration</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/enodebd">eNodeB Configuration</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/config_apn">APN Configuration</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/agw_130_upgrade">Upgrade to v1.3</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/agw_120_upgrade">Upgrade to v1.2</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/agw_110_upgrade">Upgrade to v1.1</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">AGW Development</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/tr069">Adding TR-069 support for an eNodeB</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/s1ap_tests">S1AP Integration Tests</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/lte/dev_notes">Developer Notes for Access Gateway</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Feature Guides<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/howtos/ue_metering">UE Usage Metering</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/howtos/config_agw_bridged">AGW Bridged Mode</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Federation Gateway<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Deploy FeG</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/feg/deploy_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/feg/deploy_build">Building Federation Gateway</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/feg/deploy_install">Installing Federation Gateway</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/magma/docs/1.3.0/feg/federated_FWA_setup_guide">Federated-FWA Setup Guide</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">FAQ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/faq/magma_faq">Frequently Asked Questions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Proposals<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/proposals/p001_vpn_config_from_api">Configurable VPN from Orchestrator API</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/proposals/p002_scaled_prometheus_pipeline">Scaled Prometheus Pipeline</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.3.0/proposals/p003_qos_enforcement">QoS Policy Configuration</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="federated-fwa-setup-guide"></a><a href="#federated-fwa-setup-guide" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Federated-FWA Setup Guide</h1>
<h2><a class="anchor" aria-hidden="true" id="basic-configuration-steps"></a><a href="#basic-configuration-steps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Configuration Steps</h2>
<p>For Basic installation instructions follow &quot;<a href="../feg/deploy_install">Installing Federation Gateway</a>&quot;</p>
<p>There are a few configuration steps that are not yet exposed in NMS that must be done manually via the REST API.</p>
<p>Magma has two important concepts on federation:</p>
<ul>
<li><strong>Federation Network:</strong> An entity holding the higher level configuration of a given federation method. For example, in a system without a PCRF federation this may hold the network-wide policy rules.</li>
<li><strong>Federated LTE Network:</strong> An entity holding the specific configurations for a given LTE federation. For example, this may hold Gx/Gy/S6a specific configurations such as the availability of each interface on the gateway and the target servers.</li>
</ul>
<p>When configuring an integration with LTE nodes, it is necessary to link these two entities as described in the following sections.</p>
<h3><a class="anchor" aria-hidden="true" id="associating-federatedlte-network-to-a-federation-network"></a><a href="#associating-federatedlte-network-to-a-federation-network" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Associating FederatedLTE network to a Federation network</h3>
<p>In the <strong>Federated LTE</strong> <strong>Network</strong>’s NMS page, the Federation config should be the <strong>Federation</strong> <strong>Network</strong>’s network ID.</p>
<p><img src="/magma/docs/assets/feg/NMS-FederatedLTE-Config.png" alt="NMS-FederatedLTE-Config.png"></p>
<h3><a class="anchor" aria-hidden="true" id="associating-federation-network-to-a-federatedlte-network"></a><a href="#associating-federation-network-to-a-federatedlte-network" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Associating Federation network to a FederatedLTE network</h3>
<p>In order to complete the association, we also need to modify the <strong>Federation Network</strong>‘s federation configuration.</p>
<p><img src="/magma/docs/assets/feg/API-Federation-Network-Config.png" alt="API-Federation-Network-Config.png"></p>
<p>Ensure that the following field “served_network_ids” has the <strong>Federated LTE</strong> <strong>Network</strong> networkID.</p>
<pre><code class="hljs">  <span class="hljs-string">"served_network_ids"</span>: [
    <span class="hljs-string">"fwa_agw_1"</span>
  ]
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="enabling-relay-to-feg"></a><a href="#enabling-relay-to-feg" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enabling Relay To FeG</h3>
<p>In <strong>Federated LTE</strong> <strong>Network</strong>’s EPC configuration, ensure both of the relay flags are set to <code>true</code>.</p>
<p><img src="/magma/docs/assets/feg/API-LTE-Network-EPC-Config.png" alt="API-LTE-Network-EPC-Config.png"></p>
<pre><code class="hljs">  <span class="hljs-attr">"gx_gy_relay_enabled":</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span>
  <span class="hljs-attr">"hss_relay_enabled":</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="configuring-policies"></a><a href="#configuring-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuring Policies</h3>
<p>The NMS page for  <strong>Federated LTE Network</strong> has the following policy configuration page.</p>
<p><img src="/magma/docs/assets/feg/NMS-Policy-Config.png" alt="NMS-Policy-Config.png"></p>
<h3><a class="anchor" aria-hidden="true" id="configuring-omnipresentnetwork-wide-policies"></a><a href="#configuring-omnipresentnetwork-wide-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuring Omnipresent/Network-Wide Policies</h3>
<p>Omnipresent rules or Network-Wide polices are policies that do not require a PCRF to install. On Session creation, all network wide policies will be installed for the session along with any other policies configured by the PCRF.
In the policy configuration’s edit dialogue, use the <strong>Network Wide</strong> check box to toggle the configuration.</p>
<p><img src="/magma/docs/assets/feg/NMS-Network-Wide-Rules-Config.png" alt="NMS-Network-Wide-Rules-Config.png"></p>
<h2><a class="anchor" aria-hidden="true" id="advanced-configuration-steps"></a><a href="#advanced-configuration-steps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Advanced Configuration Steps</h2>
<h3><a class="anchor" aria-hidden="true" id="enabling-redirection-support"></a><a href="#enabling-redirection-support" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enabling Redirection Support</h3>
<p>In order to enable FUA-redirection support, enable the <code>redirectd</code> service in the magmad configuration.</p>
<p><img src="/magma/docs/assets/feg/API-LTE-Magmad-Config.png" alt="API-LTE-Magmad-Config.png"></p>
<pre><code class="hljs"><span class="hljs-string">"dynamic_services"</span>: [<span class="hljs-string">"eventd"</span>,<span class="hljs-string">"td-agent-bit"</span>,<span class="hljs-string">"redirectd"</span>]
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="disable-gx--gy"></a><a href="#disable-gx--gy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Disable Gx / Gy</h3>
<p><strong>DisableGy</strong>: Useful for cases where no OCS / charging policies are configured.</p>
<p><strong>DisableGx</strong>: For PCRF-less deployments. In this setting, omnipresent policies must be added to the networks’ subscriber_config. If the rules contain a rating group, credit usage will be reported through the Gy interface.</p>
<p><img src="/magma/docs/assets/feg/API-Federation-Network-Config.png" alt="API-Federation-Network-Config.png"></p>
<p>The relevant configurations for disabling Gx/Gy are:</p>
<pre><code class="hljs"><span class="hljs-attr">"gx":</span> <span class="hljs-string">{</span>
    <span class="hljs-attr">"disableGx":</span> <span class="hljs-literal">false</span><span class="hljs-string">,</span>
<span class="hljs-string">},</span>
<span class="hljs-attr">"gy":</span> <span class="hljs-string">{</span>
    <span class="hljs-attr">"disableGy":</span> <span class="hljs-literal">false</span><span class="hljs-string">,</span>
<span class="hljs-string">}</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="plmn-filter"></a><a href="#plmn-filter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>PLMN filter</h3>
<p>FEG allows filtering subscribers by PLMN id. If the subscriber does not belong to a PLMN, the request will not be sent to HSS and FEG will return an UNAUTHORIZED message.</p>
<p>To enable this feature add a list <code>plmn_ids</code> to <code>s6a</code> and add a list of PLMN ids. The list can contain 5 digit or 6 digit PLMN ids. If the list is empty or null, s6a will send any IMSI request to HSS.</p>
<p><img src="/magma/docs/assets/feg/API-Federation-Network-Config.png" alt="API-Federation-Network-Config.png"></p>
<pre><code class="hljs"><span class="hljs-string">"s6a"</span>: {
    <span class="hljs-string">"plmn_ids"</span>: [
      <span class="hljs-string">"123456"</span>
    ],
}
</code></pre>
<p>This feature is disabled by default (so any session request from any IMSI will be sent to HSS)</p>
<h2><a class="anchor" aria-hidden="true" id="basic-sanity-checks"></a><a href="#basic-sanity-checks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Sanity Checks</h2>
<h3><a class="anchor" aria-hidden="true" id="feg"></a><a href="#feg" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FeG</h3>
<ul>
<li>Here are the steps to test the FeG &lt;-&gt; Gx/Gy/S6a connections
<ul>
<li>Exec into <code>session_proxy</code> container: <code>docker exec -it session_proxy bash</code></li>
<li>Run <code>/var/opt/magma/bin/gx_client_cli</code>with the following parameters
<ul>
<li>--commands=IT</li>
<li>--dest_host</li>
<li>--dest_realm</li>
<li>--addr</li>
<li>--realm</li>
<li>--host</li>
<li>--imsi</li>
</ul></li>
<li>Run <code>/var/opt/magma/bin/gy_client_cli</code> with the following parameters
<ul>
<li>--commands=IT</li>
<li>--addr</li>
</ul></li>
<li>Run <code>/var/opt/magma/bin/s6a_client_cli air &lt;IMSI&gt;</code>
<ul>
<li>Example: <code>/var/opt/magma/bin/s6a_cli air 001010000091111</code></li>
</ul></li>
</ul></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="agw"></a><a href="#agw" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>AGW</h3>
<ul>
<li>Ensure the basic AGW features are healthy. (Checkin, Bootstrapping, etc.)</li>
<li>Ensure that <strong>enable_config_streamer</strong> is set in <code>/etc/magma/magmad.yml</code></li>
<li>Ensure that the streamed SessionD config shows <strong>gxGyRelayEnabled</strong> as set
<ul>
<li>Run <code>magma_get_config.py -s sessiond</code></li>
</ul></li>
<li>Ensure that the streamed SubscriberDB config shows <strong>hssRelayEnabled</strong> as set
<ul>
<li>Run <code>magma_get_config.py -s subscriberdb</code></li>
</ul></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="various-debugging--issue-reporting-tips"></a><a href="#various-debugging--issue-reporting-tips" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Various Debugging / Issue Reporting Tips</h2>
<h3><a class="anchor" aria-hidden="true" id="pcaps"></a><a href="#pcaps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>PCAPs</h3>
<ul>
<li>For any Gx/Gy/S6a issues, a PCAP on FeG is extremely helpful.</li>
<li>For any AGW issue, a PCAP on AGW is probably useful.</li>
<li>For Gx/Gy issues, SessionD + SessionProxy logs are useful</li>
<li>For datapath issues, SessionD + PipelineD logs are useful</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="log-levels"></a><a href="#log-levels" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Log Levels</h3>
<ul>
<li>SessionD’s log level at ‘DEBUG’ level to get granular insight on data usage tracking</li>
<li>Enabling logging for GRPC messages between services
<ul>
<li>For AGW, modify <code>/etc/environment</code> to include <code>MAGMA_PRINT_GRPC_PAYLOAD=&quot;1&quot;</code> and restart all services. This flag will only work for the SessionD service on the AGW.</li>
<li>For FeG, add the environment variable in the docker-compose file as the following.</li>
</ul></li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">environment:</span>
    <span class="hljs-attr">MAGMA_PRINT_GRPC_PAYLOAD:</span> <span class="hljs-number">1</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/magma/docs/1.3.0/feg/deploy_install"><span class="arrow-prev">← </span><span class="function-name-prevnext">Install FeG</span></a><a class="docs-next button" href="/magma/docs/1.3.0/faq/magma_faq"><span>Next</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#basic-configuration-steps">Basic Configuration Steps</a><ul class="toc-headings"><li><a href="#associating-federatedlte-network-to-a-federation-network">Associating FederatedLTE network to a Federation network</a></li><li><a href="#associating-federation-network-to-a-federatedlte-network">Associating Federation network to a FederatedLTE network</a></li><li><a href="#enabling-relay-to-feg">Enabling Relay To FeG</a></li><li><a href="#configuring-policies">Configuring Policies</a></li><li><a href="#configuring-omnipresentnetwork-wide-policies">Configuring Omnipresent/Network-Wide Policies</a></li></ul></li><li><a href="#advanced-configuration-steps">Advanced Configuration Steps</a><ul class="toc-headings"><li><a href="#enabling-redirection-support">Enabling Redirection Support</a></li><li><a href="#disable-gx--gy">Disable Gx / Gy</a></li><li><a href="#plmn-filter">PLMN filter</a></li></ul></li><li><a href="#basic-sanity-checks">Basic Sanity Checks</a><ul class="toc-headings"><li><a href="#feg">FeG</a></li><li><a href="#agw">AGW</a></li></ul></li><li><a href="#various-debugging--issue-reporting-tips">Various Debugging / Issue Reporting Tips</a><ul class="toc-headings"><li><a href="#pcaps">PCAPs</a></li><li><a href="#log-levels">Log Levels</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/magma/" class="nav-home"><img src="/magma/img/magma_icon.png" alt="Magma Documentation" width="66"/></a><div><h5>Docs</h5><a href="https://github.com/facebookincubator/magma/blob/master/docs/Magma_Product_Overview.pdf">Magma Product Overview</a><a href="https://github.com/facebookincubator/magma/blob/master/docs/Magma_Specs_V1.1.pdf">Magma Spec</a></div><div><h5>Community</h5><a href="https://discord.gg/4YxZbft">Discord</a><a href="https://fb.me/magmadevsummit" target="_blank" rel="noreferrer noopener">Magma Dev Summit</a></div><div><h5>More</h5><a href="https://code.fb.com/open-source/magma/">Blog</a><a href="https://github.com/facebookincubator/magma">GitHub</a></div></section><section class="copyright">Copyright © 2021 The Magma Authors</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f95caeb7bc059b294eec88e340e5445b',
                indexName: 'magma',
                inputSelector: '#search_input_react'
              });
            </script></body></html>