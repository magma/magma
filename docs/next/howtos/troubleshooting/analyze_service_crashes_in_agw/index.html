<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Analyze Service crashes in AGW · Magma Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Analyze Service crashes in AGW"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Analyze Service crashes in AGW · Magma Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://magma.github.io/magma/"/><meta property="og:description" content="# Analyze Service crashes in AGW"/><meta property="og:image" content="https://magma.github.io/magma/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://magma.github.io/magma/img/docusaurus.png"/><link rel="shortcut icon" href="/magma/img/icon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script type="text/javascript" src="/init.js"></script><script src="/magma/js/scrollSpy.js"></script><link rel="stylesheet" href="/magma/css/main.css"/><script src="/magma/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/magma/"><img class="logo" src="/magma/img/magma-logo.svg" alt="Magma Documentation"/><h2 class="headerTitleWithLogo">Magma Documentation</h2></a><a href="/magma/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://magmacore.org" target="_self">Home</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="/magma/" target="_self">Docs</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://github.com/magma" target="_self">Code</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://magmacore.org/community" target="_self">Community</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Troubleshooting</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/next/basics/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/basics/prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/basics/quick_start_guide">Quick Start Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Usage<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">How-To</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/ue_metering">UE Usage Metering</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/config_agw_bridged">AGW Bridged Mode</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/call_tracing">Call Tracing</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/events_monitoring">Events Monitoring</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/he_api">Header Enrichment</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/inbound_roaming">Inbound Roaming</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/thanos">Thanos</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">NMS</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/dashboard">Dashboard</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/equipment">Equipment</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/network">Network</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/subscriber">Subscriber</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/traffic">Traffic</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/metrics">Metrics</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/alerts">Alerts</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/federation">Federation</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/admin">Admin</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/tips_and_tricks">Tips and Tricks</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Troubleshooting</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/troubleshooting/agw_unable_to_checkin">Access Gateway Unable to Check-in to Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/troubleshooting/user_unable_to_attach">User is unable to attach to Magma</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/troubleshooting/update_certificates">Update rootCA and controller SSL certificates</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/troubleshooting/generate_admin_operator_certificates">Generate and update admin_operator certificates</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/magma/docs/next/howtos/troubleshooting/analyze_service_crashes_in_agw">Analyze Service crashes in AGW</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/howtos/troubleshooting/datapath_connectivity">Debugging AGW datapath issues</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Architecture<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/architecture_overview">Overview</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/architecture_overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/architecture_modularity">Modularity</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/architecture_security">Security</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">NMS</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/nms_arch_overview">Overview</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Deploy<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/deploy_install">Install AGW on Debian Stretch.</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/deploy_install_ubuntu">Install AGW</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/deploy_config_agw">Configure AGW</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/deploy_config_enodebd">Configure eNodeB</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/deploy_config_apn">Configure an APN</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/deploy_config_agw_ha">Configure AGW for HA</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/build_install_magma_pkg_in_agw">Build and install a magma package in AGW</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/integrate_sentry">Sentry Integration</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/deploy_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/deploy_build">Build Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/deploy_install">Install Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/hold_terraform_state_on_s3">Hold Terraform state outside my local machine</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/override_values_of_terraform_files">Override values of Terraform files</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/deploy_orcl">Experimental Orc8r Deployer</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/deploy_faq">FAQs</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">NMS</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/deploy_config">Configure NMS</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Federation Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/feg/deploy_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/feg/deploy_build">Build FeG</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/feg/deploy_install">Install FeG</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/feg/deploy_configure">Configure FeG</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Upgrade<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/upgrade_1_5">Upgrade to v1.5</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/upgrade_1_4">Upgrade to v1.4</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/upgrade_1_3">Upgrade to v1.3</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/upgrade_1_2">Upgrade to v1.2</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/upgrade_1_1">Upgrade to v1.1</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/upgrade_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/upgrade_1_5">Upgrade to v1.5</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/upgrade_1_4">Upgrade to v1.4</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/upgrade_1_3">Upgrade to v1.3</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/upgrade_1_2">Upgrade to v1.2</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/upgrade_1_1">Upgrade to v1.1</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Debug<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/debug_show_tech">Show Tech</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/debug_dp_probe">Datapath Probe CLI</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Federated Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/feg/debug_cli">Feg Cli</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/debug_logs">View Logs</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Contribute<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/next/contributing/contribute_onboarding">Developer Onboarding</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/contributing/contribute_workflow">Development Workflow</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/contributing/contribute_conventions">Contributing Conventions</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/contributing/contribute_ci_checks">Continuous Integration Checks</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/contributing/contribute_codeowners">Codeowners Workflow</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Technical Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">General</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/resources/ref_pcap">PCAP Collection</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/resources/ref_useful_links">Useful Links</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/dev_notes">Developer Notes</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/dev_unit_testing">Unit Testing</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/tr069">Add eNB TR-069 Support</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/s1ap_tests">S1AP Integration Tests</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/eventd">Event Reporting</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/lte/access_service_restrictions">Restricting Network Access</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/dev_testing">Testing Tips</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/dev_minikube">Deploy on Minikube</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/dev_security">Security</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/dev_indexers">State Indexers</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/dev_dependencies">Module Dependencies</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/orc8r/dev_aws_stack">AWS Stack</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">NMS</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/dev_spacing">Spacing Guidelines</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/dev_themes">Themes</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/nms/dev_components">Components</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Proposals<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p001_vpn_config_from_api">Configurable VPN from Orchestrator API</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p002_scaled_prometheus_pipeline">Scaled Prometheus Pipeline</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p003_qos_enforcement">QoS Policy Configuration</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p005_call_tracing">Call Tracing for Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p007_header_enrichment">Header enrichment</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p008_apn_correction">MME APN Correction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p009_nms_mariadb_migration">NMS MariaDB Migration</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p010_subscriber_scaling">Subscriber Scaling</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p011_victoriametrics">VictoriaMetrics as Magma&#x27;s TSDB</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p013_Ubuntu_upgrade">AGW Ubuntu upgrade</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p014_proposal_process">Magma Proposals</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p015_tech_debt_week">Tech Debt Week Processes</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/next/proposals/p017_apn_refactoring">APN Refactoring Proposal</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">FAQ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/next/faq/faq_magma">Frequently Asked Questions</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="analyze-service-crashes-in-agw"></a><a href="#analyze-service-crashes-in-agw" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Analyze Service crashes in AGW</h1>
<p><strong>Description:</strong> Purpose of this guide is to identify if an outage or service restart (mme, sessiond) was caused due
to an AGW service crash.</p>
<p><strong>Environment:</strong> AGW deployed on bare metal</p>
<p><strong>Components:</strong> AGW</p>
<p><strong>Triaging steps:</strong></p>
<p><strong>1.  Identify and quantify the impact.</strong> Verify if there is any temporary or permanent drop in metrics related to
service:</p>
<ul>
<li><p>Number of Connected eNBs (Grafana -&gt; Dashboards -&gt; Networks)</p></li>
<li><p>Network of Connected UE (Grafana -&gt; Dashboards -&gt; Networks)</p></li>
<li><p>Network of Registered UE (Grafana -&gt; Dashboards -&gt; Networks)</p></li>
<li><p>Attach/ Reg attempts (Grafana -&gt; Dashboards -&gt; Networks)</p></li>
<li><p>Attach Success Rate (Grafana -&gt; Dashboards -&gt; Networks)</p></li>
<li><p>S6a Authentication Success Rate (Grafana -&gt; Dashboards -&gt; Networks)</p></li>
<li><p>Service Request Success Rate (Grafana -&gt; Dashboards -&gt; Networks)</p></li>
<li><p>Session Create Success Rate (Grafana -&gt; Dashboards -&gt; Networks)</p></li>
<li><p>Upload/Download Throughput (Grafana -&gt; Dashboards -&gt; Gateway)</p>
<p>Note: Number of sites(enodeb) down, users affected, and outage duration are key indicators of service impact.</p></li>
</ul>
<p><strong>2. Use metrics to verify if there was a recent service restart</strong> and if this correlates with the metrics degradation. Get an estimated timestamp from the metrics. You can use the following metrics:</p>
<ul>
<li><p>unexpected_service_restarts</p></li>
<li><p>service_restart_status</p></li>
</ul>
<p><strong>3. Verify if the restart was intentionally triggered</strong> by a user (AGW reboot)</p>
<ul>
<li><p>Use <code>last reboot</code> to list the last logged in users and system last reboot time and date.</p>
<p>Use this timestamp and compare with the timestamp in the metrics degradation to confirm both events are related(Consider the time zone difference between Orc8r and AGW.)</p>
<p>If the service was not intentionally restarted. Follow below steps to confirm the outage was caused due to a service crash.</p></li>
</ul>
<p><strong>4. Capture the service crash syslogs and coredumps</strong>. Use the approximate time in metrics and look for the events in both syslogs and coredumps</p>
<ul>
<li>In syslogs located in <code>/var/log</code>, look for service terminating events and its previous logs. For example, in below mme service crash there is a segfault reported in mme service before its being terminated.</li>
</ul>
<pre><code class="hljs">Dec <span class="hljs-number">5</span> <span class="hljs-number">22</span>:<span class="hljs-number">25</span>:<span class="hljs-number">55</span> magma kernel: [<span class="hljs-number">266759.489500</span>] ITTI <span class="hljs-number">3</span>[<span class="hljs-number">13887</span>]: segfault at <span class="hljs-number">1</span>d6d80 ip <span class="hljs-number">000055</span>b0080da0c2 sp <span class="hljs-number">00007f</span>529e6c0310 error <span class="hljs-number">4</span> <span class="hljs-keyword">in</span> mme[<span class="hljs-number">55</span>b0077bd000+e79000]
Dec <span class="hljs-number">5</span> <span class="hljs-number">22</span>:<span class="hljs-number">25</span>:<span class="hljs-number">59</span> magma systemd[<span class="hljs-number">1</span>]: <span class="hljs-symbol">magma@</span>mme.service: Main process exited, code=killed, status=<span class="hljs-number">11</span>/SEGV
</code></pre>
<ul>
<li>Service crashes with a segmentation fault will create coredumps in <code>/var/core/</code> folder. Verify if coredumps have been created and obtain the coredump that matches the time of the outage/crash. Depending on the type of service crash the name of the coredump will vary. More detail in <a href="https://magma.github.io/magma/docs/lte/dev_notes#analyzing-coredumps">https://magma.github.io/magma/docs/lte/dev_notes#analyzing-coredumps</a></li>
</ul>
<p><strong>5. Get the backtrace using the coredumps</strong>. To analyze the coredumps, you need 3 requirements.</p>
<ul>
<li><p>Coredump file</p></li>
<li><p>service binary, (ie. for mme <code>/usr/local/bin/mme</code>)</p></li>
<li><p>gdb package installed</p></li>
</ul>
<p>You can read the coredumps in any AGW or machine with these requirements. Example:  <code>gdb mme core-1607217955-ITTI</code></p>
<p>Within the gdb shell, <code>bt</code> command will display the backtrace for the segmentation fault. You should expect
an output like this:</p>
<pre><code class="hljs"><span class="hljs-selector-tag">203</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">nas</span>/<span class="hljs-selector-tag">nas_procedures</span><span class="hljs-selector-class">.c</span>: <span class="hljs-selector-tag">No</span> <span class="hljs-selector-tag">such</span> <span class="hljs-selector-tag">file</span> <span class="hljs-selector-tag">or</span> <span class="hljs-selector-tag">directory</span>.
<span class="hljs-selector-attr">[Current thread is 1 (process 13887)]</span>
(gdb) <span class="hljs-selector-tag">bt</span>
<span class="hljs-selector-id">#0</span>  <span class="hljs-selector-tag">get_nas_specific_procedure_attach</span> (ctxt=ctxt<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x6210000d64b0) <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">nas</span>/<span class="hljs-selector-tag">nas_procedures</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:203</span>
<span class="hljs-selector-id">#1</span>  <span class="hljs-selector-tag">0x000055b0080c2aa8</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">emm_proc_attach_request</span> (ue_id=ue_id<span class="hljs-variable">@entry</span>=<span class="hljs-number">2819</span>, is_mm_ctx_new=is_mm_ctx_new<span class="hljs-variable">@entry</span>=true, ies=&lt;optimized out&gt;, ies<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x608000054280)
    <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">nas</span>/<span class="hljs-selector-tag">emm</span>/<span class="hljs-selector-tag">Attach</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:318</span>
<span class="hljs-selector-id">#2</span>  <span class="hljs-selector-tag">0x000055b0080e5e1f</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">emm_recv_attach_request</span> (ue_id=&lt;optimized out&gt;, originating_tai=originating_tai<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x7f529e6c24d2, originating_ecgi=originating_ecgi<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x7f529e6c2660,
    msg=msg<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x7f529e6c1e10, is_initial=&lt;optimized out&gt;, is_mm_ctx_new=&lt;optimized out&gt;, emm_cause=&lt;optimized out&gt;, decode_status=&lt;optimized out&gt;)
    <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">nas</span>/<span class="hljs-selector-tag">emm</span>/<span class="hljs-selector-tag">sap</span>/<span class="hljs-selector-tag">emm_recv</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:384</span>
<span class="hljs-selector-id">#3</span>  <span class="hljs-selector-tag">0x000055b0080e27b4</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">_emm_as_establish_req</span> (msg=msg<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x7f529e6c25e0, emm_cause=emm_cause<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x7f529e6c257c)
    <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">nas</span>/<span class="hljs-selector-tag">emm</span>/<span class="hljs-selector-tag">sap</span>/<span class="hljs-selector-tag">emm_as</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:802</span>
<span class="hljs-selector-id">#4</span>  <span class="hljs-selector-tag">0x000055b0080e4460</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">emm_as_send</span> (msg=msg<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x7f529e6c25d8) <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">nas</span>/<span class="hljs-selector-tag">emm</span>/<span class="hljs-selector-tag">sap</span>/<span class="hljs-selector-tag">emm_as</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:185</span>
<span class="hljs-selector-id">#5</span>  <span class="hljs-selector-tag">0x000055b0080d1720</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">emm_sap_send</span> (msg=msg<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x7f529e6c25d0) <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">nas</span>/<span class="hljs-selector-tag">emm</span>/<span class="hljs-selector-tag">sap</span>/<span class="hljs-selector-tag">emm_sap</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:105</span>
<span class="hljs-selector-id">#6</span>  <span class="hljs-selector-tag">0x000055b0080b7037</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">nas_proc_establish_ind</span> (ue_id=ue_id<span class="hljs-variable">@entry</span>=<span class="hljs-number">2819</span>, is_mm_ctx_new=&lt;optimized out&gt;, originating_tai=..., ecgi=..., as_cause=&lt;optimized out&gt;, s_tmsi=...,
    s_tmsi<span class="hljs-variable">@entry</span>=..., msg=<span class="hljs-number">0</span>x629000302036) <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">nas</span>/<span class="hljs-selector-tag">nas_proc</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:185</span>
<span class="hljs-selector-id">#7</span>  <span class="hljs-selector-tag">0x000055b007ebbf87</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">mme_app_handle_initial_ue_message</span> (mme_app_desc_p=mme_app_desc_p<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x60800000b500, initial_pP=initial_pP<span class="hljs-variable">@entry</span>=<span class="hljs-number">0</span>x629000302026)
    <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">mme_app</span>/<span class="hljs-selector-tag">mme_app_bearer</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:727</span>
<span class="hljs-selector-id">#8</span>  <span class="hljs-selector-tag">0x000055b007ebab98</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">handle_message</span> (loop=&lt;optimized out&gt;, reader=&lt;optimized out&gt;, arg=&lt;optimized out&gt;) <span class="hljs-selector-tag">at</span> /<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">vagrant</span>/<span class="hljs-selector-tag">magma</span>/<span class="hljs-selector-tag">lte</span>/<span class="hljs-selector-tag">gateway</span>/<span class="hljs-selector-tag">c</span>/<span class="hljs-selector-tag">oai</span>/<span class="hljs-selector-tag">tasks</span>/<span class="hljs-selector-tag">mme_app</span>/<span class="hljs-selector-tag">mme_app_main</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-pseudo">:182</span>
</code></pre>
<p><strong>6. Obtain event that triggered the crash</strong>. Every time a service restarts it will generate a log file (i.e. mme.log). Inside the coredump folder you will find the log (i.e. mme.log) that was generated just before the crash. In order to understand what was the event that triggered the crash, get the last event (Attach Request, Detach, timer expiring, etc.) in the log file.</p>
<p>Note: If you can't find the timestamp of the crash in syslogs, you can use the last log generated in the log found in the coredump to get the exact timestamp of that crash.</p>
<p><strong>7. Put together all information and isolate different root causes</strong>. If you have multiple crashes, make sure you perform these steps for each of these events. This will help to confirm the crashes are happening due a single or multiple issue. For each event, you should collect the following information</p>
<ul>
<li>Detail of Impact</li>
<li>mme binary and the magma version deployed</li>
<li>Log in the syslog of the crash</li>
<li>Backtrace, reading the coredump</li>
<li>Get the event that triggered the crash in mme log</li>
</ul>
<p><strong>8. Investigate or seek for help</strong>. Use the collected information to look into previous Github issues/bugs and confirm if this is a known issue or bug that has been fixed in a later version. Otherwise, open a new report with the information collected.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/magma/docs/next/howtos/troubleshooting/generate_admin_operator_certificates"><span class="arrow-prev">← </span><span>Generate and update admin_operator certificates</span></a><a class="docs-next button" href="/magma/docs/next/howtos/troubleshooting/datapath_connectivity"><span>Debugging AGW datapath issues</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/magma/" class="nav-home"><img src="/magma/img/magma_icon.png" alt="Magma Documentation" width="66"/></a><div><h5>Docs</h5><a href="https://github.com/facebookincubator/magma/blob/master/docs/Magma_Product_Overview.pdf">Magma Product Overview</a><a href="https://github.com/facebookincubator/magma/blob/master/docs/Magma_Specs_V1.1.pdf">Magma Spec</a></div><div><h5>Community</h5><a href="https://discord.gg/4YxZbft">Discord</a><a href="https://fb.me/magmadevsummit" target="_blank" rel="noreferrer noopener">Magma Dev Summit</a></div><div><h5>More</h5><a href="https://code.fb.com/open-source/magma/">Blog</a><a href="https://github.com/facebookincubator/magma">GitHub</a></div></section><section class="copyright">Copyright © 2021 The Magma Authors</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f95caeb7bc059b294eec88e340e5445b',
                indexName: 'magma',
                inputSelector: '#search_input_react'
              });
            </script></body></html>