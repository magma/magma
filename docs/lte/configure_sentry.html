<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Sentry Integration · Magma Documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Sentry + Magma AGW"/><meta name="docsearch:version" content="1.6.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Sentry Integration · Magma Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://magma.github.io/magma/"/><meta property="og:description" content="# Sentry + Magma AGW"/><meta property="og:image" content="https://magma.github.io/magma/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://magma.github.io/magma/img/docusaurus.png"/><link rel="shortcut icon" href="/magma/img/icon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script type="text/javascript" src="/init.js"></script><script src="/magma/js/scrollSpy.js"></script><link rel="stylesheet" href="/magma/css/main.css"/><script src="/magma/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/magma/"><img class="logo" src="/magma/img/magma-logo.svg" alt="Magma Documentation"/><h2 class="headerTitleWithLogo">Magma Documentation</h2></a><a href="/magma/versions"><h3>1.6.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://magmacore.org" target="_self">Home</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="/magma/" target="_self">Docs</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://github.com/magma" target="_self">Code</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://magmacore.org/community" target="_self">Community</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="sentry--magma-agw"></a><a href="#sentry--magma-agw" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sentry + Magma AGW</h1>
<p><a href="https://sentry.io/welcome/">Sentry</a> is an error monitoring platform. Members of the Magma community are able to request access to link one access gateway in their lab to the Linux Foundation Sentry page. Alternatively, users can set up their own instance of Sentry outside of the Magma community.</p>
<p>As part of v1.5, we have integrated Sentry's <a href="https://docs.sentry.io/platforms/native/">Native</a> (C/C++) SDK to enable basic error / stacktrace collection.</p>
<h2><a class="anchor" aria-hidden="true" id="connect-to-the-linux-foundation-sentry-account"></a><a href="#connect-to-the-linux-foundation-sentry-account" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Connect to the Linux Foundation Sentry Account</h2>
<p>The first step to setting up your account is to request access to Linux Foundation <a href="http://Sentry.io">Sentry.io</a> instance by submitting your email address and company through the <a href="https://docs.google.com/forms/d/e/1FAIpQLSeJMWecw9An5-aYv0US8Fc_PDO7kUMx4Pky13S_3LhFJkge_g/viewform">community form</a>. You should also create a team for your company on the Sentry site. This team name should match your company and will be used to enable group access to your project. Once you are granted access, you will need to login and navigate to the “Projects” tab and locate your team’s project name. You will need this information to update the CircleCI config.yml file on the Magma Github.</p>
<h2><a class="anchor" aria-hidden="true" id="configuration"></a><a href="#configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h2>
<p>To configure Sentry, you will need to create a pull request to update the config.yml on the Magma Github page. If you skip this step, all C/C++ will be unreadable for your Sentry instance. This file is located <a href="https://github.com/magma/magma/blob/master/.circleci/config.yml">here</a>. You will need to navigate to the &quot;sentry-create-and-upload-artifacts&quot; section of the file and create a new a new sentry upload in the following format:</p>
<pre><code class="hljs css language-bash">sentry-upload:
executable_name: &lt;&lt; parameters.executable_name &gt;&gt;
project: [fill <span class="hljs-keyword">in</span> your project here]
org: lf-9c
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="enabling-error-reporting-on-an-agw"></a><a href="#enabling-error-reporting-on-an-agw" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enabling error reporting on an AGW</h2>
<p>Reporting for Python services, MME, and SessionD will <em>only</em> be enabled if the corresponding URL fields are non-empty.</p>
<p>Fill out the following fields in <code>control_proxy.yml</code> to enable Sentry reporting.</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># [Experimental] Sentry related configs</span>
<span class="hljs-comment"># If set, the Sentry Python SDK will be initialized for all python services</span>
sentry_url_python: <span class="hljs-string">""</span>
<span class="hljs-comment"># If set, the Sentry Native SDK will be initialized for MME and SessionD</span>
sentry_url_native: <span class="hljs-string">""</span>
<span class="hljs-comment"># If set, /var/log/mme.log will be uploaded along MME crash reports</span>
sentry_upload_mme_log: <span class="hljs-literal">false</span>
<span class="hljs-comment"># A sampling rate to apply to events. A value of 0.0 will send no</span>
<span class="hljs-comment"># events, and a value of 1.0 will send all events (default).</span>
sentry_sample_rate: 1.0
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="monitoring"></a><a href="#monitoring" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Monitoring</h2>
<p>Once your Sentry instance is established we recommend setting up alerts and your dashboard to monitor your results. This will allow you to understand the health of your network and also enable you to view key metrics such as crash rate per release.</p>
<p>Follow the Sentry dashboard instructions <a href="https://docs.sentry.io/product/dashboards/">here</a> to understand the dashboard page, and use the instructions <a href="https://docs.sentry.io/product/dashboards/custom-dashboards/">here</a> to set up a custom dashboard. In order to set up alerts to Slack or email, follow the Sentry instructions <a href="https://docs.sentry.io/product/alerts/">here</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="non-linux-foundation-sentry-accounts-uploading-debug-information-files-for-sessiond-and-mme"></a><a href="#non-linux-foundation-sentry-accounts-uploading-debug-information-files-for-sessiond-and-mme" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Non-Linux Foundation Sentry Accounts: Uploading debug information files for SessionD and MME</h2>
<p>To fully enable stacktrace analysis for any services running with the Native SDK, you will need to upload the corresponding debug information files for the stacktraces to be readable in Sentry.</p>
<p>For more information, please refer to <a href="https://docs.sentry.io/platforms/android/data-management/debug-files/">this documentation provided by Sentry</a>.</p>
<p>In order for the build artifacts to have a debug section, they have to be built with the <code>-g</code> compiler flag. The flag is set by default for all C/C++ services, so no additional change is necessary for this.</p>
<p>The following script outlines the necessary steps.</p>
<pre><code class="hljs css language-bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># To install sentry-cli, run `curl -sL https://sentry.io/get-cli/ | bash`</span>

TODO: change me!
EXECS_PATHS=<span class="hljs-string">""</span>
ORG=<span class="hljs-string">""</span>
PROJECT=<span class="hljs-string">""</span>

<span class="hljs-keyword">for</span> EXEC <span class="hljs-keyword">in</span> <span class="hljs-variable">$EXECS_PATHS</span>
<span class="hljs-keyword">do</span>
    <span class="hljs-comment"># Strip artifacts</span>
    objcopy --only-keep-debug <span class="hljs-string">"<span class="hljs-variable">$EXEC</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$EXEC</span>"</span>.debug
    objcopy --strip-debug --strip-unneeded <span class="hljs-string">"<span class="hljs-variable">$EXEC</span>"</span>

   <span class="hljs-comment"># [Optional] Log included debug information</span>
    sentry-cli difutil check <span class="hljs-string">"<span class="hljs-variable">$EXEC</span>"</span>
    sentry-cli difutil check <span class="hljs-string">"<span class="hljs-variable">$EXEC</span>"</span>.debug


    <span class="hljs-comment"># Upload the debug artifact with `symtab`, `debug`, and `sources`</span>
    sentry-cli upload-dif --<span class="hljs-built_in">log</span>-level=info --org=<span class="hljs-string">"<span class="hljs-variable">$ORG</span>"</span> --project=<span class="hljs-string">"<span class="hljs-variable">$PROJECT</span>"</span> --include-sources  <span class="hljs-string">"<span class="hljs-variable">$EXEC</span>"</span>.debug
    <span class="hljs-comment"># Upload the stripped executable with `unwind`</span>
    sentry-cli upload-dif --<span class="hljs-built_in">log</span>-level=info --org=<span class="hljs-string">"<span class="hljs-variable">$ORG</span>"</span> --project=<span class="hljs-string">"<span class="hljs-variable">$PROJECT</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$EXEC</span>"</span>
<span class="hljs-keyword">done</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#connect-to-the-linux-foundation-sentry-account">Connect to the Linux Foundation Sentry Account</a></li><li><a href="#configuration">Configuration</a></li><li><a href="#enabling-error-reporting-on-an-agw">Enabling error reporting on an AGW</a></li><li><a href="#monitoring">Monitoring</a></li><li><a href="#non-linux-foundation-sentry-accounts-uploading-debug-information-files-for-sessiond-and-mme">Non-Linux Foundation Sentry Accounts: Uploading debug information files for SessionD and MME</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/magma/" class="nav-home"><img src="/magma/img/magma_icon.png" alt="Magma Documentation" width="66"/></a><div><h5>Docs</h5><a href="https://github.com/facebookincubator/magma/blob/master/docs/Magma_Product_Overview.pdf">Magma Product Overview</a><a href="https://github.com/facebookincubator/magma/blob/master/docs/Magma_Specs_V1.1.pdf">Magma Spec</a></div><div><h5>Community</h5><a href="https://discord.gg/4YxZbft">Discord</a><a href="https://fb.me/magmadevsummit" target="_blank" rel="noreferrer noopener">Magma Dev Summit</a></div><div><h5>More</h5><a href="https://code.fb.com/open-source/magma/">Blog</a><a href="https://github.com/facebookincubator/magma">GitHub</a></div></section><section class="copyright">Copyright © 2021 The Magma Authors</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f95caeb7bc059b294eec88e340e5445b',
                indexName: 'magma',
                inputSelector: '#search_input_react'
              });
            </script></body></html>