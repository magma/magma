<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>eNodeB Configuration · Magma</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# eNodeB Configuration"/><meta name="docsearch:version" content="1.0.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="eNodeB Configuration · Magma"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebookincubator.github.io/magma/"/><meta property="og:description" content="# eNodeB Configuration"/><meta property="og:image" content="https://facebookincubator.github.io/magma/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://facebookincubator.github.io/magma/img/docusaurus.png"/><link rel="shortcut icon" href="/magma/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/magma/js/scrollSpy.js"></script><link rel="stylesheet" href="/magma/css/main.css"/><script src="/magma/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/magma/"><img class="logo" src="/magma/img/fb.png" alt="Magma"/><h2 class="headerTitleWithLogo">Magma</h2></a><a href="/magma/versions"><h3>1.0.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/magma/docs/basics/introduction" target="_self">Docs</a></li><li class=""><a href="/magma/help" target="_self">Help</a></li><li class=""><a href="https://github.com/facebookincubator/magma" target="_self">Github</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Access Gateway</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Basics<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/basics/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/basics/prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/basics/quick_start_guide">Quick Start Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Orchestrator<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Deploying Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/orc8r/deploy_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/orc8r/deploy_build">Building Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/orc8r/deploy_terraform">Terraforming Orchestrator on AWS</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/orc8r/deploy_install">Installing Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/orc8r/deploy_dns">DNS Resolution</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Access Gateway<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/lte/setup_deb">Setup (Bare Metal)</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/lte/config_agw">AGW Configuration</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/magma/docs/lte/enodebd">eNodeB Configuration</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/lte/tr069">Adding TR-069 support for an eNodeB</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Federation Gateway<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Deploying FeG</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/feg/deploy_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/feg/deploy_build">Building Federation Gateway</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/feg/deploy_install">Installing Federation Gateway</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Symphony<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/symphony/quick_start">Symphony Agent Quick Start</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/symphony/building_the_symphony_agent">Building the Symphony Agent</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="enodeb-configuration"></a><a href="#enodeb-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>eNodeB Configuration</h1>
<h2><a class="anchor" aria-hidden="true" id="prerequisites"></a><a href="#prerequisites" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h2>
<p>Make sure you follow the instructions in &quot;<a href="https://facebookincubator.github.io/magma/docs/orc8r/deploying">Deploying Orchestrator</a>&quot; for successful
installation of Orchestrator and the instructions in &quot;<a href="https://facebookincubator.github.io/magma/docs/lte/config_agw">AGW Configuration</a>&quot; to provision and
configure your Access Gateway (AGW).</p>
<h2><a class="anchor" aria-hidden="true" id="s1-interface"></a><a href="#s1-interface" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>S1 interface</h2>
<p>Connect your eNodeB to the <code>eth1</code> interface of Magma gateway. Magma uses <code>eth1</code>
as the default <code>S1</code> interface. If you have more than one eNodeB, use an L2
switch to connect all <code>S1</code> interfaces. For debugging purposes, you may find it
particularly useful to do the following:</p>
<ol>
<li>Configure a managed L2 switch (e.g. <a href="https://www.amazon.com/NETGEAR-GS108T-200NAS-GS108Tv2-Lifetime-Protection/dp/B07PS6Z162/">this NETGEAR</a>)
to mirror port X and port Y to port Z.</li>
<li>Connect port X of that switch to the <code>eth1</code> interface on your AGW.</li>
<li>Connect the WAN interface on your enodeB to port Y on the switch.</li>
<li>Connect your host to port Z on the switch.</li>
</ol>
<p>This will allow you to do live packet captures with Wireshark from your host to
debug the S1 interface between the enodeB and the AGW (filter for SCTP).</p>
<h2><a class="anchor" aria-hidden="true" id="automatic-configuration"></a><a href="#automatic-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Automatic configuration</h2>
<p><em>Magma officially supports auto-configuration of the following devices:</em></p>
<ul>
<li>Baicells Nova-243 Outdoor FDD/TDD eNodeB
<ul>
<li>Firmware Version: BaiBS_RTS_3.1.6</li>
</ul></li>
<li>Baicells mBS1100 LTE-TDD Base Station
<ul>
<li>Firmware Version: BaiStation_V100R001C00B110SPC003</li>
</ul></li>
<li>Baicells Neutrino-244 ID FDD/TDD enodeB</li>
</ul>
<p><em>Magma supports the following management protocols:</em></p>
<ul>
<li>TR-069 (CWMP)</li>
</ul>
<p><em>Magma supports configuration of the following data models:</em></p>
<ul>
<li>TR-196 data model</li>
<li>TR-181 data model</li>
</ul>
<p>The Magma team plans to add support for more devices and management protocols.</p>
<p>To handle automatic configuration of eNodeB devices on your network, Magma
uses the <code>enodebd</code> service. The <code>enodebd</code> service is responsible for handling
the O&amp;M interface between Magma and any connected eNodeB. The <code>enodebd</code> service
can be disabled if you configure your eNodeB devices manually.</p>
<h3><a class="anchor" aria-hidden="true" id="baicells"></a><a href="#baicells" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Baicells</h3>
<p>Use the enodeB's management interface to set the management server URL to
<code>baiomc.cloudapp.net:48080</code>. Magma uses DNS hijacking to point the eNodeB to
the configuration server being run by enodebd. <code>baiomc.cloudapp.net:48080</code>
will point to <code>192.88.99.142</code>, the IP address that the TR-069 ACS is
being hosted on.</p>
<h2><a class="anchor" aria-hidden="true" id="provisioning-your-enodeb-on-nms"></a><a href="#provisioning-your-enodeb-on-nms" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Provisioning Your eNodeB on NMS</h2>
<p>Get the serial number of your eNodeB, you'll need it to register the device.
On the NMS, navigate to &quot;eNodeB Devices&quot; in the sidebar, and hit &quot;Add EnodeB&quot;.
Configure the RAN parameters as necessary. Note that fields left blank will
be inherited from either the network or gateway LTE parameters:</p>
<p><img src="/magma/docs/assets/nms/configure_enb.png" alt="Configuring an eNodeB"></p>
<p>Then, go back to the &quot;Gateways&quot; page and edit the LTE configuration of your
AGW. Enter the serial number of the enodeB you just provisioned into the
&quot;Registered eNodeBs&quot; field, then hit save.</p>
<h3><a class="anchor" aria-hidden="true" id="basic-troubleshooting"></a><a href="#basic-troubleshooting" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Troubleshooting</h3>
<p>After connecting your eNodeB(s) to the gateway through the <code>eth1</code> interface, you
may want to check a few things if auto-configuration is not working.</p>
<p>Magma will be running a DHCP server to assign an IP address to your connected
eNodeB. Check if an IP address gets assigned to your eNodeB by either checking
the eNodeB UI or monitoring the <code>dnsd</code> service.</p>
<pre><code class="hljs">journalctl -u <span class="hljs-symbol">magma@</span>dnsd -f
# Check <span class="hljs-keyword">for</span> a similar log
# DHCPDISCOVER(eth1) <span class="hljs-number">48</span>:bf:<span class="hljs-number">74</span>:<span class="hljs-number">07</span>:<span class="hljs-number">68</span>:ee
# DHCPOFFER(eth1) <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span> <span class="hljs-number">48</span>:bf:<span class="hljs-number">74</span>:<span class="hljs-number">07</span>:<span class="hljs-number">68</span>:ee
# DHCPREQUEST(eth1) <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span> <span class="hljs-number">48</span>:bf:<span class="hljs-number">74</span>:<span class="hljs-number">07</span>:<span class="hljs-number">68</span>:ee
# DHCPACK(eth1) <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span> <span class="hljs-number">48</span>:bf:<span class="hljs-number">74</span>:<span class="hljs-number">07</span>:<span class="hljs-number">68</span>:ee
</code></pre>
<p>Use the <code>enodebd_cli.py</code> tool to check basic status of eNodeB(s). It also allows
for querying the value of parameters, setting them, and sending reboot requests
to the eNodeB. The following example gets the status of all connected eNodeBs.</p>
<pre><code class="hljs">enodebd_cli.py get_all_status
<span class="hljs-meta"># --- eNodeB Serial: 120200002618AGP0001 ---</span>
<span class="hljs-meta"># IP Address..................10.0.2.246</span>
<span class="hljs-meta"># eNodeB connected.....................1</span>
<span class="hljs-meta"># eNodeB Configured....................1</span>
<span class="hljs-meta"># Opstate Enabled......................1</span>
<span class="hljs-meta"># RF TX on.............................1</span>
<span class="hljs-meta"># RF TX desired........................1</span>
<span class="hljs-meta"># GPS Connected........................0</span>
<span class="hljs-meta"># PTP Connected........................0</span>
<span class="hljs-meta"># MME Connected........................1</span>
<span class="hljs-meta"># GPS Longitude...............113.902069</span>
<span class="hljs-meta"># GPS Latitude.................22.932018</span>
<span class="hljs-meta"># FSM State...............Completed provisioning eNB. Awaiting new Inform.</span>
</code></pre>
<p>It may take time for the eNodeB to start transmitting because <code>enodebd</code> will
reboot the eNodeB to apply new configurations. Monitor the progress of <code>enodebd</code>
using the following command</p>
<pre><code class="hljs"><span class="hljs-attribute">journalctl</span> -u magma<span class="hljs-variable">@enodebd</span> -f
<span class="hljs-comment"># Check for a similar log</span>
<span class="hljs-comment"># INFO:root:Successfully configured CPE parameters!</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="manual-configuration"></a><a href="#manual-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Manual configuration</h2>
<p>Manual configuration of connected eNodeB(s) is always possible. Magma was tested
with multiple Airspan eNodeB models configured through NetSpan management
software.
When manually configuring eNodeBs, make sure the eNodeB configuration matches
that of the Magma cellular configuration. Pay special attention to the
configuration of <code>PLMN</code>, <code>EARFCN</code> and <code>TAC</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="basic-troubleshooting-1"></a><a href="#basic-troubleshooting-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Troubleshooting</h3>
<p>When manually configuring your eNodeB, you can use the manufacturers tools or
interfaces to monitor and troubleshoot the eNodeB configuration.</p>
<p>You can also listen to the <code>S1</code> interface traffic and validate a proper <code>S1</code>
setup and handshake. Below are the <code>SCTP</code> packets exchanged between the eNodeB
and MME.</p>
<pre><code class="hljs">Source        Destination    Protocol  Length   Info
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>       SCTP      <span class="hljs-number">66</span>       INIT
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>     SCTP      <span class="hljs-number">298</span>      INIT_ACK
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>       SCTP      <span class="hljs-number">278</span>      COOKIE_ECHO
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>     SCTP      <span class="hljs-number">60</span>       COOKIE_ACK
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>       S1AP      <span class="hljs-number">106</span>      S1SetupRequest
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>     SCTP      <span class="hljs-number">62</span>       SACK
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>     S1AP      <span class="hljs-number">90</span>       S1SetupResponse
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>       SCTP      <span class="hljs-number">62</span>       SACK
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>       SCTP      <span class="hljs-number">66</span>       HEARTBEAT
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>     SCTP      <span class="hljs-number">66</span>       HEARTBEAT_ACK
</code></pre>
<h1><a class="anchor" aria-hidden="true" id="connecting-your-first-user"></a><a href="#connecting-your-first-user" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Connecting your first user</h1>
<h2><a class="anchor" aria-hidden="true" id="adding-subscribers"></a><a href="#adding-subscribers" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding subscribers</h2>
<p>Once your eNodeB starts transmitting, UEs may attempt to attach to your
network. Your AGW will reject these attach requests due to authentication
failure until you add the corresponding IMSI to the subscriber database.</p>
<p>On the NMS, go to &quot;Subscribers&quot;, then &quot;Add Subscriber&quot;. The SIM secrets can be
entered either in hex or base64-encoded binary:</p>
<p><img src="/magma/docs/assets/nms/add_sub.png" alt="Adding a subscriber"></p>
<p>Subscriber information will eventually propagate to the AGW. You can verify
using the CLI command <code>&quot;subscriber_cli.py list&quot;</code></p>
<h2><a class="anchor" aria-hidden="true" id="validating-ue-connectivity"></a><a href="#validating-ue-connectivity" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Validating UE connectivity</h2>
<p>Validating UE connectivity can be done from the UE side, MME side, or by
listening to traffic on the <code>S1</code> interface.
Below is a typical UE attach procedure as captured on the <code>S1</code> interface.</p>
<pre><code class="hljs">Source        Destination   Protocol        Info
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      S1AP/NAS-EPS    InitialUEMessage, Attach request, PDN connectivity request
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    S1AP/NAS-EPS    DownlinkNASTransport, Identity request
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      S1AP/NAS-EPS    UplinkNASTransport, Identity response
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    S1AP/NAS-EPS    DownlinkNASTransport, Authentication request
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      S1AP/NAS-EPS    UplinkNASTransport, Authentication response
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    S1AP/NAS-EPS    DownlinkNASTransport, Security mode command
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      S1AP/NAS-EPS    UplinkNASTransport, Security mode complete
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    S1AP/NAS-EPS    DownlinkNASTransport, ESM information request
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      S1AP/NAS-EPS    UplinkNASTransport, ESM information response
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    S1AP/NAS-EPS    InitialContextSetupRequest, Attach accept, Activate <span class="hljs-section">default</span> EPS bearer context request
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      S1AP            UECapabilityInfoIndication, UECapabilityInformation
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      S1AP            InitialContextSetupResponse
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      S1AP/NAS-EPS    UplinkNASTransport, Attach complete, Activate <span class="hljs-section">default</span> EPS bearer context accept
<span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span>      <span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-number">.246</span>    S1AP/NAS-EPS    DownlinkNASTransport, EMM information
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/magma/docs/lte/config_agw"><span class="arrow-prev">← </span><span>AGW Configuration</span></a><a class="docs-next button" href="/magma/docs/lte/tr069"><span class="function-name-prevnext">Adding TR-069 support for an eNodeB</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#s1-interface">S1 interface</a></li><li><a href="#automatic-configuration">Automatic configuration</a><ul class="toc-headings"><li><a href="#baicells">Baicells</a></li></ul></li><li><a href="#provisioning-your-enodeb-on-nms">Provisioning Your eNodeB on NMS</a><ul class="toc-headings"><li><a href="#basic-troubleshooting">Basic Troubleshooting</a></li></ul></li><li><a href="#manual-configuration">Manual configuration</a><ul class="toc-headings"><li><a href="#basic-troubleshooting-1">Basic Troubleshooting</a></li></ul></li><li><a href="#adding-subscribers">Adding subscribers</a></li><li><a href="#validating-ue-connectivity">Validating UE connectivity</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/magma/" class="nav-home"><img src="/magma/img/fb.png" alt="Magma" width="66" height="58"/></a><div><h5>Docs</h5><a href="https://github.com/facebookincubator/magma/blob/master/docs/Magma_Product_Overview.pdf">Magma Product Overview</a><a href="https://github.com/facebookincubator/magma/blob/master/docs/Magma_Specs_V1.1.pdf">Magma Spec</a></div><div><h5>Community</h5><a href="https://discord.gg/4YxZbft">Discord</a><a href="https://fb.me/magmadevsummit" target="_blank" rel="noreferrer noopener">Magma Dev Summit</a></div><div><h5>More</h5><a href="https://code.fb.com/open-source/magma/">Blog</a><a href="https://github.com/facebookincubator/magma">GitHub</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/magma/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Facebook</section></footer></div></body></html>